#!/bin/bash

# Pokémon list
POKEMON_LIST=("bulbasaur" "ivysaur" "venusaur" "charmander" "charmeleon")

# Output directory
OUTPUT_DIR="pokemon_data"
ERROR_LOG="errors_parallel.log"

# Create directory and clear log
mkdir -p "$OUTPUT_DIR"
> "$ERROR_LOG"

# Function to fetch Pokémon data
fetch_pokemon() {
    local name=$1
    local output_file="$OUTPUT_DIR/$name.json"

    echo "Fetching data for $name..."

    response=$(curl -s -w "%{http_code}" -o "$output_file" "https://pokeapi.co/api/v2/pokemon/$name")

    if [ "$response" -eq 200 ]; then
        echo "✅ Saved data to $output_file"
    else
        echo "❌ Failed to fetch $name (HTTP $response)" | tee -a "$ERROR_LOG"
        rm -f "$output_file"
    fi
}

# Launch each fetch in the background
for pokemon in "${POKEMON_LIST[@]}"; do
    fetch_pokemon "$pokemon" &
done

# Wait for all background processes to complete
wait

echo "✅ All data fetches completed."
